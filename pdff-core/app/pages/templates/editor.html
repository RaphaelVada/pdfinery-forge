<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PDF Metadaten bearbeiten - PDFF Core</title>
    
    <!-- Design System -->
    <link rel="stylesheet" href="/static/css/theme.css">
    <link rel="stylesheet" href="/static/css/editor.css">
</head>
<body>
    <header>
        <h1>📄 PDF Metadaten bearbeiten</h1>
        <div class="current-filename" id="currentFilename">Lade...</div>
    </header>

    <div class="container">
        <!-- PDF Preview -->
        <div class="pdf-viewer">
            <iframe class="pdf-embed" id="pdfViewer"></iframe>
        </div>

        <!-- Metadata Editor -->
        <div class="metadata-panel">
            <div class="metadata-form">
                <!-- Error Display -->
                <div id="errorBox" class="error" style="display: none;"></div>

                <!-- Metadata Input Section -->
                <div class="form-section">
                    <h3 class="section-title">📝 Metadaten bearbeiten</h3>
                    
                    <pdff-input-field
                        name="correspondent"
                        label="Korrespondent"
                        type="text"
                        required>
                    </pdff-input-field>

                    <pdff-input-field
                        name="document_type"
                        label="Dokumenttyp"
                        type="text"
                        required>
                    </pdff-input-field>

                    <pdff-input-field
                        name="topic"
                        label="Thema/Betreff"
                        type="text"
                        placeholder="z.B. Jahresabrechnung 2024">
                    </pdff-input-field>

                    <pdff-input-field
                        name="customer_id"
                        label="Kundennummer (optional)"
                        type="text">
                    </pdff-input-field>

                    <pdff-input-field
                        name="document_number"
                        label="Dokumentnummer (optional)"
                        type="text">
                    </pdff-input-field>

                    <pdff-input-field
                        name="document_date"
                        label="Datum"
                        type="date">
                    </pdff-input-field>

                    <!-- Status & Save -->
                    <pdff-status-indicator 
                        status="not-generatable"
                        filename="---">
                        <button 
                            slot="action" 
                            class="btn btn-primary" 
                            id="saveBtn" 
                            disabled>
                            💾 Speichern
                        </button>
                    </pdff-status-indicator>
                </div>

                <!-- Navigation Section -->
                <div class="form-section">
                    <h3 class="section-title">
                        🧭 Navigation 
                        <span id="navPosition" style="opacity: 0.6; font-size: 0.8rem;"></span>
                    </h3>
                    
                    <div class="navigation-buttons">
                        <button type="button" class="btn" id="btnPrevious" disabled>
                            ← Vorheriges
                        </button>
                        <button type="button" class="btn" id="btnNext" disabled>
                            Nächstes →
                        </button>
                    </div>
                    
                    <div class="navigation-info">
                        <div id="previousInfo">---</div>
                        <div id="nextInfo">---</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Web Components -->
    <script type="module">
        // Import base component first
        import './static/js/components/base-component.js';
        
        // Import UI components
        import './static/js/components/pdff-input-field.js';
        import './static/js/components/pdff-status-indicator.js';
        
        // Import controller
        import { EditorController } from './static/js/editor-controller.js';
        
        // Initialize when DOM is ready
        document.addEventListener('DOMContentLoaded', () => {
            const controller = new EditorController(
                "{{ api_url }}", 
                "{{ document_id }}"
            );
            controller.init();
        });
    </script>
</body>
</html>